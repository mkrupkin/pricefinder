<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PriceFinder AI - –ó–Ω–∞–π–¥–∏ –Ω–∞–π–∫—Ä–∞—â—É —Ü—ñ–Ω—É</title>
    <meta name="description" content="–®—Ç—É—á–Ω–∏–π —ñ–Ω—Ç–µ–ª–µ–∫—Ç –∑–Ω–∞—Ö–æ–¥–∏—Ç—å –Ω–∞–π–∫—Ä–∞—â—ñ —Ü—ñ–Ω–∏ –Ω–∞ —Ç–æ–≤–∞—Ä–∏ –ø–æ —Ñ–æ—Ç–æ –∞–±–æ –æ–ø–∏—Å—ñ. –ü–æ—à—É–∫ –Ω–∞ 200+ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö —Å–≤—ñ—Ç—É.">
    <meta name="keywords" content="–ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Ü—ñ–Ω, –ø–æ—à—É–∫ —Ç–æ–≤–∞—Ä—ñ–≤, —à—Ç—É—á–Ω–∏–π —ñ–Ω—Ç–µ–ª–µ–∫—Ç, —Ü—ñ–Ω–∏ –æ–Ω–ª–∞–π–Ω, —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è —Ñ–æ—Ç–æ">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <!-- Axios -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.2/axios.min.js"></script>

    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%23667eea'/><text y='50' x='50' text-anchor='middle' dominant-baseline='central' font-size='40' fill='white'>PF</text></svg>">

    <style>
        .ai-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .ai-glow {
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }

        .neural-bg {
            background-image:
                    radial-gradient(circle at 20% 50%, rgba(102, 126, 234, 0.1) 0%, transparent 50%),
                    radial-gradient(circle at 80% 20%, rgba(118, 75, 162, 0.1) 0%, transparent 50%),
                    radial-gradient(circle at 40% 80%, rgba(56, 189, 248, 0.1) 0%, transparent 50%);
        }

        .ai-pulse {
            animation: ai-pulse 2s infinite;
        }

        @keyframes ai-pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .floating {
            animation: floating 3s ease-in-out infinite;
        }

        @keyframes floating {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .neon-border {
            border: 2px solid;
            border-image: linear-gradient(45deg, #667eea, #764ba2, #38bdf8) 1;
        }

        .ai-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .hologram {
            background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.5) 50%, transparent 70%);
            background-size: 200% 200%;
            animation: hologram 3s ease-in-out infinite;
        }

        @keyframes hologram {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .drag-over {
            border-color: #667eea !important;
            background-color: rgba(102, 126, 234, 0.1) !important;
        }

        .loading-skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        * {
            transition: all 0.3s ease;
        }

        @media (max-width: 640px) {
            .ai-card {
                margin: 0.5rem;
                padding: 1rem;
            }
        }
    </style>
</head>
<body class="neural-bg">
<div id="app">
    <!-- Loading fallback -->
    <div v-if="isLoading" class="min-h-screen flex items-center justify-center">
        <div class="text-center">
            <div class="ai-gradient p-6 rounded-2xl mb-4 inline-block">
                <i class="fas fa-brain fa-spin text-4xl text-white"></i>
            </div>
            <p class="text-gray-600">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è PriceFinder AI...</p>
        </div>
    </div>

    <!-- Main App -->
    <div v-else class="min-h-screen neural-bg">
        <!-- Header Component -->
        <app-header :api-status="apiStatus"></app-header>

        <!-- Error Message Component -->
        <error-message v-if="errorMessage" :message="errorMessage" @close="hideError"></error-message>

        <main class="max-w-6xl mx-auto px-4 py-8">
            <!-- Search Section Component -->
            <search-section
                    :search-mode="searchMode"
                    :selected-image="selectedImage"
                    :text-query="textQuery"
                    :is-analyzing="isAnalyzing"
                    @set-photo-mode="setPhotoMode"
                    @set-text-mode="setTextMode"
                    @image-upload="handleImageUpload"
                    @image-selection="handleFileSelection"
                    @analyze="analyzeProduct"
                    @update-text-query="textQuery = $event"
                    @key-press="handleKeyPress"
                    @set-suggestion="setSuggestion">
            </search-section>

            <!-- Loading Component -->
            <analysis-loading
                    v-if="isAnalyzing"
                    :search-mode="searchMode"
                    :text-query="textQuery">
            </analysis-loading>

            <!-- Results Component -->
            <results-section
                    v-if="results.length > 0"
                    :results="results"
                    :product-name="productName"
                    :search-mode="searchMode"
                    :view-mode="viewMode"
                    :selected-store="selectedStore"
                    :min-price="minPrice"
                    :international-count="internationalCount"
                    :local-count="localCount"
                    @set-view-mode="viewMode = $event"
                    @select-store="selectStore"
                    @call-store="callStore"
                    @visit-store="visitStore">
            </results-section>
        </main>
    </div>
</div>

<script>
    const { createApp, ref, computed, onMounted, nextTick } = Vue;

    // API Service Layer
    class PriceFinderAPI {
        constructor() {
            this.baseURL = '/api';
            this.setupAxios();
        }

        setupAxios() {
            axios.defaults.timeout = 30000;
            axios.defaults.headers.common['Content-Type'] = 'application/json';
        }

        async checkStatus() {
            try {
                const response = await axios.get('/', { timeout: 5000 });
                return response.status === 200 ? 'online' : 'error';
            } catch (error) {
                console.error('API status check failed:', error);
                return 'offline';
            }
        }

        async fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result.split(',')[1]);
                reader.onerror = reject;
            });
        }

        async analyzeProduct(searchMode, data) {
            let requestData = {
                user_location: {
                    country: 'Ukraine',
                    city: 'Kyiv'
                }
            };

            if (searchMode === 'photo') {
                const imageBase64 = await this.fileToBase64(data.file);
                requestData.image = imageBase64;
                requestData.image_name = data.file.name;
                requestData.image_type = data.file.type;
            } else {
                requestData.text_query = data.textQuery.trim();
            }

            const response = await axios.post(`${this.baseURL}/gpt`, requestData, {
                timeout: 60000,
                headers: {
                    'Content-Type': 'multipart/form-data'
                }
            });


            return response.data;
        }
    }

    // Utility functions
    const utils = {
        getStoreIcon(storeName) {
            const name = storeName.toLowerCase();
            const icons = {
                'rozetka': 'üõí',
                'amazon': 'üì¶',
                'aliexpress': 'üèÆ',
                'olx': 'üíº',
                'comfy': 'üè™',
                'eldorado': '‚ö°',
                'moyo': 'üì±',
                'prom': 'üõçÔ∏è'
            };
            return Object.keys(icons).find(key => name.includes(key)) ? icons[Object.keys(icons).find(key => name.includes(key))] : 'üè¨';
        },

        getStoreColor(storeName) {
            const name = storeName.toLowerCase();
            const colors = {
                'rozetka': 'bg-gradient-to-r from-green-500 to-green-600',
                'amazon': 'bg-gradient-to-r from-gray-700 to-gray-900',
                'aliexpress': 'bg-gradient-to-r from-red-500 to-orange-500',
                'olx': 'bg-gradient-to-r from-purple-500 to-purple-700',
                'comfy': 'bg-gradient-to-r from-orange-500 to-orange-600',
                'eldorado': 'bg-gradient-to-r from-blue-500 to-blue-600'
            };
            return Object.keys(colors).find(key => name.includes(key)) ? colors[Object.keys(colors).find(key => name.includes(key))] : 'bg-gradient-to-r from-indigo-500 to-purple-600';
        },

        calculateDiscount(original, current) {
            if (!original || !current) return 0;
            return Math.round(((original - current) / original) * 100);
        },

        formatPrice(price) {
            if (!price || price === 0) return '–£—Ç–æ—á–Ω—é–π—Ç–µ —Ü—ñ–Ω—É';
            return new Intl.NumberFormat('uk-UA', {
                style: 'currency',
                currency: 'UAH',
                maximumFractionDigits: 0
            }).format(price);
        },

        getDeliveryIcon(type) {
            const icons = {
                'local': 'fas fa-truck text-green-600',
                'international': 'fas fa-plane text-blue-600',
                'marketplace': 'fas fa-store text-purple-600'
            };
            return icons[type] || 'fas fa-box text-gray-600';
        },

        getTypeLabel(type) {
            const labels = {
                'local': '–õ–æ–∫–∞–ª—å–Ω–∏–π',
                'international': '–ì–ª–æ–±–∞–ª—å–Ω–∏–π',
                'marketplace': '–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å'
            };
            return labels[type] || '–ú–∞–≥–∞–∑–∏–Ω';
        },

        determineStoreType(result) {
            if (result.store_type === 'official_retailer') return 'local';
            if (result.location?.region === 'International') return 'international';
            return 'marketplace';
        }
    };

    // Header Component
    const AppHeader = {
        props: ['apiStatus'],
        template: `
            <header class="ai-card shadow-lg border-b border-white/20">
                <div class="max-w-6xl mx-auto px-4 py-6">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <div class="ai-gradient p-3 rounded-xl ai-glow floating relative">
                                <i class="fas fa-search-dollar text-white text-2xl sm:text-3xl"></i>
                                <div class="absolute -top-1 -right-1 w-3 h-3 bg-green-400 rounded-full ai-pulse"></div>
                            </div>
                            <div>
                                <h1 class="text-2xl sm:text-3xl font-bold bg-gradient-to-r from-purple-600 via-blue-600 to-purple-600 bg-clip-text text-transparent">
                                    PriceFinder AI
                                </h1>
                                <p class="text-sm sm:text-base text-gray-600">
                                    –®—Ç—É—á–Ω–∏–π —ñ–Ω—Ç–µ–ª–µ–∫—Ç –∑–Ω–∞–π–¥–µ –Ω–∞–π–∫—Ä–∞—â—É —Ü—ñ–Ω—É ‚Ä¢ –ê–Ω–∞–ª—ñ–∑ 200+ –ø–ª–∞—Ç—Ñ–æ—Ä–º —Å–≤—ñ—Ç—É
                                </p>
                            </div>
                        </div>

                        <div class="hidden sm:flex items-center space-x-4">
                            <div class="flex items-center space-x-2 text-sm text-gray-600">
                                <i class="fas fa-robot text-purple-600"></i>
                                <span>AI {{ apiStatus === 'online' ? '–∞–∫—Ç–∏–≤–Ω–∏–π' : apiStatus === 'checking' ? '–ø–µ—Ä–µ–≤—ñ—Ä–∫–∞...' : '–ø–æ–º–∏–ª–∫–∞' }}</span>
                                <div :class="[
                                    'w-2 h-2 rounded-full',
                                    apiStatus === 'online' ? 'bg-green-400 ai-pulse' :
                                    apiStatus === 'offline' ? 'bg-red-400' : 'bg-yellow-400 ai-pulse'
                                ]"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
        `
    };

    // Error Message Component
    const ErrorMessage = {
        props: ['message'],
        emits: ['close'],
        template: `
            <div class="max-w-6xl mx-auto px-4 py-4">
                <div class="bg-red-50 border border-red-200 rounded-xl p-4 flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <i class="fas fa-exclamation-triangle text-red-600"></i>
                        <span class="text-red-800">{{ message }}</span>
                    </div>
                    <button @click="$emit('close')" class="text-red-600 hover:text-red-800">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
        `
    };

    // Search Section Component
    const SearchSection = {
        props: ['searchMode', 'selectedImage', 'textQuery', 'isAnalyzing'],
        emits: ['set-photo-mode', 'set-text-mode', 'image-upload', 'image-selection', 'analyze', 'update-text-query', 'key-press', 'set-suggestion'],
        template: `
            <div class="ai-card rounded-2xl shadow-xl p-8 mb-8 relative overflow-hidden">
                <div class="relative z-10">
                    <!-- AI Mode Toggle -->
            <div class="flex items-center justify-center mb-8">
            <div class="ai-gradient p-1 rounded-xl shadow-lg">
            <div class="bg-white/10 backdrop-blur p-1 rounded-lg flex items-center space-x-2">
            <button
            @click="$emit('set-photo-mode')"
            :class="[
            'flex items-center space-x-2 px-4 sm:px-6 py-3 rounded-lg transition-all font-semibold text-sm sm:text-base',
            searchMode === 'photo'
            ? 'bg-white text-purple-600 shadow-lg'
            : 'text-white hover:bg-white/20'
            ]"
            >
            <i class="fas fa-camera text-lg"></i>
            <span class="hidden sm:inline">–®–Ü-–∞–Ω–∞–ª—ñ–∑ —Ñ–æ—Ç–æ</span>
            <span class="sm:hidden">–§–æ—Ç–æ</span>
            </button>
            <button
            @click="$emit('set-text-mode')"
            :class="[
            'flex items-center space-x-2 px-4 sm:px-6 py-3 rounded-lg transition-all font-semibold text-sm sm:text-base',
            searchMode === 'text'
            ? 'bg-white text-purple-600 shadow-lg'
            : 'text-white hover:bg-white/20'
            ]"
            >
            <i class="fas fa-brain text-lg"></i>
            <span class="hidden sm:inline">–†–æ–∑—É–º–Ω–∏–π –ø–æ—à—É–∫</span>
            <span class="sm:hidden">–¢–µ–∫—Å—Ç</span>
            </button>
            </div>
            </div>
            </div>

            <!-- Photo Mode -->
            <photo-search
            v-if="searchMode === 'photo'"
            :selected-image="selectedImage"
            :is-analyzing="isAnalyzing"
            @image-upload="$emit('image-upload', $event)"
            @analyze="$emit('analyze')">
            </photo-search>

            <!-- Text Mode -->
            <text-search
            v-else
            :text-query="textQuery"
            :is-analyzing="isAnalyzing"
            @update-text-query="$emit('update-text-query', $event)"
            @key-press="$emit('key-press', $event)"
            @analyze="$emit('analyze')"
            @set-suggestion="$emit('set-suggestion', $event)">
            </text-search>
            </div>
            </div>
            `
    };

    // Photo Search Component
    const PhotoSearch = {
        props: ['selectedImage', 'isAnalyzing'],
        emits: ['image-upload', 'analyze'],
        template: `
        <div class="flex flex-col items-center space-y-6">
        <div v-if="!selectedImage">
        <label class="cursor-pointer group block">
        <div id="upload-area" class="neon-border rounded-2xl p-8 sm:p-12 w-full max-w-lg h-60 sm:h-72 flex flex-col items-center justify-center transition-all group-hover:shadow-2xl group-hover:scale-105 bg-gradient-to-br from-purple-50 to-blue-50 relative overflow-hidden">
        <div class="absolute inset-0 hologram opacity-20"></div>
        <div class="relative z-10 text-center">
        <div class="mb-4 sm:mb-6">
        <i class="fas fa-cloud-upload-alt text-4xl sm:text-6xl text-purple-600 group-hover:text-blue-600 transition-colors ai-pulse"></i>
        </div>
        <p class="text-lg sm:text-xl font-bold text-gray-800 mb-2 sm:mb-3">
        –®–Ü –ø—Ä–æ–∞–Ω–∞–ª—ñ–∑—É—î –≤–∞—à–µ —Ñ–æ—Ç–æ
        </p>
        <p class="text-xs sm:text-sm text-gray-600">
        PNG, JPG –∞–±–æ WEBP (–º–∞–∫—Å. 10MB)<br>
        –†–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è –±—É–¥—å-—è–∫–∏—Ö —Ç–æ–≤–∞—Ä—ñ–≤
        </p>
        </div>
        </div>
        <input type="file" class="hidden" accept="image/*" @change="$emit('image-upload', $event)" />
        </label>
        </div>

        <div v-else class="space-y-6">
        <div class="relative">
        <img :src="selectedImage" alt="–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è"
        class="w-full max-w-lg h-60 sm:h-72 object-cover rounded-2xl shadow-2xl neon-border" />
        <div class="absolute top-4 right-4 bg-green-500 text-white px-3 py-1 rounded-full text-sm font-semibold flex items-center space-x-1">
        <i class="fas fa-check"></i>
        <span class="hidden sm:inline">–ì–æ—Ç–æ–≤–æ –¥–æ –∞–Ω–∞–ª—ñ–∑—É</span>
        <span class="sm:hidden">‚úì</span>
        </div>
        </div>
        <div class="flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-4 justify-center">
        <label class="cursor-pointer bg-gray-100 hover:bg-gray-200 px-4 sm:px-6 py-3 rounded-xl transition-all font-semibold text-center text-sm sm:text-base">
        <span>–ó–º—ñ–Ω–∏—Ç–∏ —Ñ–æ—Ç–æ</span>
        <input type="file" class="hidden" accept="image/*" @change="$emit('image-upload', $event)" />
        </label>
        <button
        @click="$emit('analyze')"
        :disabled="isAnalyzing"
        class="ai-gradient hover:shadow-2xl text-white px-6 sm:px-8 py-3 rounded-xl font-bold transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2 hover:scale-105 text-sm sm:text-base"
        >
        <i v-if="isAnalyzing" class="fas fa-spinner fa-spin"></i>
        <i v-else class="fas fa-brain"></i>
        <span class="hidden sm:inline">{{ isAnalyzing ? '–®–Ü –∞–Ω–∞–ª—ñ–∑—É—î —Ç–æ–≤–∞—Ä...' : '–ó–∞–ø—É—Å—Ç–∏—Ç–∏ –®–Ü-–∞–Ω–∞–ª—ñ–∑' }}</span>
        <span class="sm:hidden">{{ isAnalyzing ? '–ê–Ω–∞–ª—ñ–∑...' : '–ê–Ω–∞–ª—ñ–∑' }}</span>
        </button>
        </div>
        </div>
        </div>
        `
    };

    // Text Search Component
    const TextSearch = {
        props: ['textQuery', 'isAnalyzing'],
        emits: ['update-text-query', 'key-press', 'analyze', 'set-suggestion'],
        template: `
        <div class="w-full max-w-3xl mx-auto space-y-6">
        <div class="relative">
        <i class="fas fa-brain absolute left-4 top-1/2 transform -translate-y-1/2 text-purple-600 text-xl ai-pulse"></i>
        <input
        type="text"
        placeholder="–û–ø–∏—à—ñ—Ç—å —Ç–æ–≤–∞—Ä - –®–Ü –∑—Ä–æ–∑—É–º—ñ—î –±—É–¥—å-—è–∫–∏–π –æ–ø–∏—Å"
        :value="textQuery"
        @input="$emit('update-text-query', $event.target.value)"
        @keypress="$emit('key-press', $event)"
        class="w-full pl-12 pr-6 py-4 sm:py-5 border-2 border-purple-300 rounded-xl focus:border-purple-500 focus:outline-none text-base sm:text-lg bg-white/80 backdrop-blur shadow-lg"
        />
        <div class="absolute right-4 top-1/2 transform -translate-y-1/2 hidden sm:block">
        <div class="flex items-center space-x-2 text-sm text-gray-500">
        <i class="fas fa-magic"></i>
        <span>AI –≥–æ—Ç–æ–≤–∏–π</span>
        </div>
        </div>
        </div>

        <div class="flex justify-center">
        <button
        @click="$emit('analyze')"
        :disabled="isAnalyzing || !textQuery.trim()"
        class="ai-gradient hover:shadow-2xl text-white px-8 sm:px-10 py-3 sm:py-4 rounded-xl font-bold transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-3 hover:scale-105 text-base sm:text-lg"
        >
        <i v-if="isAnalyzing" class="fas fa-spinner fa-spin text-lg sm:text-xl"></i>
        <i v-else class="fas fa-brain text-lg sm:text-xl"></i>
        <span class="hidden sm:inline">{{ isAnalyzing ? '–®–Ü —à—É–∫–∞—î —Ç–æ–≤–∞—Ä...' : '–ó–∞–ø—É—Å—Ç–∏—Ç–∏ –®–Ü-–ø–æ—à—É–∫' }}</span>
        <span class="sm:hidden">{{ isAnalyzing ? '–ü–æ—à—É–∫...' : '–ü–æ—à—É–∫' }}</span>
        </button>
        </div>

        <div class="mt-8">
        <p class="text-center text-gray-600 mb-4 flex items-center justify-center space-x-2 text-sm sm:text-base">
        <i class="fas fa-lightbulb text-yellow-500"></i>
        <span>–ü—Ä–∏–∫–ª–∞–¥–∏ –¥–ª—è –®–Ü:</span>
        </p>
        <div class="flex flex-wrap justify-center gap-2 sm:gap-3">
        <button
        v-for="suggestion in ['iPhone 15 Pro', '–±–µ–∑–¥—Ä–æ—Ç–æ–≤—ñ –Ω–∞–≤—É—à–Ω–∏–∫–∏', '—Ç–µ–ª–µ—Ñ–æ–Ω –∑ —Ö–æ—Ä–æ—à–æ—é –∫–∞–º–µ—Ä–æ—é', '–Ω–æ—É—Ç–±—É–∫ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤', 'Samsung Galaxy S24', 'MacBook Air']"
        :key="suggestion"
        @click="$emit('set-suggestion', suggestion)"
        class="px-3 sm:px-4 py-1 sm:py-2 bg-gradient-to-r from-purple-100 to-blue-100 hover:from-purple-200 hover:to-blue-200 text-purple-700 rounded-full transition-all hover:scale-105 font-medium text-xs sm:text-sm"
        >
        {{ suggestion }}
        </button>
        </div>
        </div>
        </div>
        `
    };

    // Analysis Loading Component
    const AnalysisLoading = {
        props: ['searchMode', 'textQuery'],
        methods: {
            getRandomProgressState() {
                return Math.random() > 0.5 ?
                    'bg-gradient-to-r from-green-500 to-blue-500' :
                    'bg-gradient-to-r from-purple-500 to-pink-500 ai-pulse';
            }
        },
        template: `
        <div class="ai-card rounded-2xl shadow-xl p-6 sm:p-8 text-center mb-8 relative overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-r from-purple-500/10 via-blue-500/10 to-green-500/10 animate-pulse"></div>
        <div class="relative z-10">
        <div class="flex items-center justify-center space-x-4 mb-6">
        <i class="fas fa-brain fa-spin text-3xl sm:text-4xl text-purple-600"></i>
        <div class="flex space-x-1">
        <div class="w-2 h-2 sm:w-3 sm:h-3 bg-purple-600 rounded-full animate-bounce"></div>
        <div class="w-2 h-2 sm:w-3 sm:h-3 bg-blue-600 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
        <div class="w-2 h-2 sm:w-3 sm:h-3 bg-green-600 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
        </div>
        </div>
        <h3 class="text-xl sm:text-2xl font-bold text-gray-800 mb-2">
        {{ searchMode === 'photo' ? '–®–Ü –∞–Ω–∞–ª—ñ–∑—É—î —Ñ–æ—Ç–æ...' : '–®–Ü —à—É–∫–∞—î —Ç–æ–≤–∞—Ä...' }}
        </h3>
        <p class="text-sm sm:text-base text-gray-600 mb-6">
        <span v-if="searchMode === 'photo'">–®–Ü —Ä–æ–∑–ø—ñ–∑–Ω–∞—î —Ç–æ–≤–∞—Ä —ñ –ø–æ—à—É–∫–∞—î –Ω–∞–π–∫—Ä–∞—â—ñ —Ü—ñ–Ω–∏</span>
        <span v-else>–®–Ü –∞–Ω–∞–ª—ñ–∑—É—î "{{ textQuery }}" —ñ —à—É–∫–∞—î –Ω–∞ 200+ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö</span>
        </p>

        <div class="grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3 mb-6">
        <div v-for="platform in ['Rozetka', 'Amazon', 'OLX', 'AliExpress', 'Comfy', 'eBay', 'Moyo', 'Eldorado']"
        :key="platform"
        class="ai-card rounded-lg p-2 sm:p-3 text-xs sm:text-sm flex items-center justify-center space-x-1 sm:space-x-2 border">
        <div :class="'w-2 h-2 rounded-full ' + getRandomProgressState()"></div>
        <span class="font-medium">{{ platform }}</span>
        </div>
        </div>

        <div class="bg-gray-200 rounded-full h-2 sm:h-3 overflow-hidden">
        <div class="ai-gradient h-2 sm:h-3 rounded-full ai-pulse transition-all duration-1000" style="width: 85%"></div>
        </div>
        </div>
        </div>
        `
    };

    // Results Section Component
    const ResultsSection = {
        props: ['results', 'productName', 'searchMode', 'viewMode', 'selectedStore', 'minPrice', 'internationalCount', 'localCount'],
        emits: ['set-view-mode', 'select-store', 'call-store', 'visit-store'],
        methods: {
            formatPrice: utils.formatPrice,
            getTypeLabel: utils.getTypeLabel,
            getDeliveryIcon: utils.getDeliveryIcon,
            getMarkerPosition(index) {
                return {
                    left: (20 + (index % 3) * 25 + Math.random() * 10) + '%',
                    top: (25 + Math.floor(index / 3) * 30 + Math.random() * 10) + '%'
                };
            }
        },
        template: `
        <div class="space-y-6 sm:space-y-8">
        <!-- Results Header -->
        <div class="ai-card rounded-2xl shadow-xl p-4 sm:p-6 relative overflow-hidden">
        <div class="relative z-10">
        <div class="flex flex-col space-y-4 lg:space-y-0 lg:flex-row lg:items-center lg:justify-between mb-6">
        <div class="flex items-center space-x-3 sm:space-x-4">
        <div class="ai-gradient p-3 sm:p-4 rounded-2xl shadow-lg">
        <i v-if="searchMode === 'photo'" class="fas fa-camera text-xl sm:text-2xl text-white"></i>
        <i v-else class="fas fa-brain text-xl sm:text-2xl text-white"></i>
        </div>
        <div>
        <h3 class="text-lg sm:text-2xl font-bold text-gray-900">
        {{ searchMode === 'photo' ? '–®–Ü —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤:' : '–®–Ü –∑–Ω–∞–π—à–æ–≤:' }}
        </h3>
        <p class="text-base sm:text-xl text-purple-600 font-bold">{{ productName }}</p>
        </div>
        </div>

        <div class="flex items-center space-x-1 sm:space-x-2 ai-gradient p-1 rounded-xl self-start lg:self-center">
        <button
        @click="$emit('set-view-mode', 'list')"
        :class="[
        'flex items-center space-x-1 sm:space-x-2 px-3 sm:px-4 py-2 rounded-lg transition-all font-semibold text-xs sm:text-sm',
        viewMode === 'list' ? 'bg-white text-purple-600 shadow-lg' : 'text-white hover:bg-white/20'
        ]"
        >
        <i class="fas fa-list"></i>
        <span>–°–ø–∏—Å–æ–∫</span>
        </button>
        <button
        @click="$emit('set-view-mode', 'map')"
        :class="[
        'flex items-center space-x-1 sm:space-x-2 px-3 sm:px-4 py-2 rounded-lg transition-all font-semibold text-xs sm:text-sm',
        viewMode === 'map' ? 'bg-white text-purple-600 shadow-lg' : 'text-white hover:bg-white/20'
        ]"
        >
        <i class="fas fa-map"></i>
        <span>–ö–∞—Ä—Ç–∞</span>
        </button>
        </div>
        </div>

        <div class="grid grid-cols-2 lg:grid-cols-4 gap-2 sm:gap-4 text-xs sm:text-sm">
        <div class="flex items-center space-x-1 sm:space-x-2 bg-purple-50 rounded-lg p-2 sm:p-3">
        <i class="fas fa-brain text-purple-600"></i>
        <span class="font-semibold">{{ results.length }} –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤</span>
        </div>
        <div class="flex items-center space-x-1 sm:space-x-2 bg-green-50 rounded-lg p-2 sm:p-3">
        <i class="fas fa-star text-green-600"></i>
        <span class="font-semibold">{{ formatPrice(minPrice) }}</span>
        </div>
        <div class="flex items-center space-x-1 sm:space-x-2 bg-blue-50 rounded-lg p-2 sm:p-3">
        <i class="fas fa-globe text-blue-600"></i>
        <span class="font-semibold">{{ internationalCount }} –≥–ª–æ–±–∞–ª—å–Ω–∏—Ö</span>
        </div>
        <div class="flex items-center space-x-1 sm:space-x-2 bg-orange-50 rounded-lg p-2 sm:p-3">
        <i class="fas fa-map-marker-alt text-orange-600"></i>
        <span class="font-semibold">{{ localCount }} –ª–æ–∫–∞–ª—å–Ω–∏—Ö</span>
        </div>
        </div>
        </div>
        </div>

        <!-- List View -->
        <results-list
        v-if="viewMode === 'list'"
        :results="results"
        @call-store="$emit('call-store', $event)"
        @visit-store="$emit('visit-store', $event)">
        </results-list>

        <!-- Map View -->
        <results-map
        v-else
        :results="results"
        :selected-store="selectedStore"
        @select-store="$emit('select-store', $event)"
        @call-store="$emit('call-store', $event)"
        @visit-store="$emit('visit-store', $event)">
        </results-map>
        </div>
        `
    };

    // Results List Component
    const ResultsList = {
        props: ['results'],
        emits: ['call-store', 'visit-store'],
        methods: {
            formatPrice: utils.formatPrice,
            getTypeLabel: utils.getTypeLabel,
            getDeliveryIcon: utils.getDeliveryIcon
        },
        template: `
        <div class="space-y-6">
        <h3 class="text-2xl font-bold bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent mb-6">
        –®–Ü-–∞–Ω–∞–ª—ñ–∑ —Ü—ñ–Ω –ø–æ –≤—Å—ñ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö:
        </h3>

        <div v-for="(result, index) in results"
        :key="result.id"
        class="ai-card rounded-2xl shadow-xl p-6 hover:shadow-2xl transition-all border-l-4 border-purple-500 relative overflow-hidden group">
        <div class="absolute inset-0 bg-gradient-to-r from-transparent via-purple-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
        <div class="relative z-10">
        <div class="flex flex-col lg:flex-row items-start justify-between space-y-6 lg:space-y-0">
        <div class="flex items-start space-x-4 flex-1">
        <div :class="result.color + ' p-4 rounded-2xl text-white text-2xl shadow-lg relative floating'">
        {{ result.logo }}
        <div class="absolute -top-1 -right-1 w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-xs">
        <i class="fas fa-check text-white"></i>
        </div>
        </div>

        <div class="flex-1">
        <div class="flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-4 mb-3">
        <h4 class="text-xl font-bold text-gray-900">{{ result.store }}</h4>
        <div class="flex flex-wrap items-center gap-2">
        <span class="bg-gray-100 text-gray-600 px-3 py-1 rounded-full text-sm font-semibold">
        {{ getTypeLabel(result.type) }}
        </span>
        <span v-if="index === 0" class="bg-gradient-to-r from-green-500 to-blue-500 text-white px-3 py-1 rounded-full text-sm font-bold">
        üèÜ –ù–∞–π–∫—Ä–∞—â–∞ —Ü—ñ–Ω–∞
        </span>
        <span class="bg-purple-100 text-purple-700 px-3 py-1 rounded-full text-sm font-semibold">
        –®–Ü-—Ä–µ–π—Ç–∏–Ω–≥: {{ result.aiScore }}%
        </span>
        </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4">
        <div class="bg-gray-50 rounded-lg p-3 space-y-2">
        <div class="flex items-center space-x-2 text-sm">
        <i class="fas fa-star text-yellow-500"></i>
        <span class="font-semibold">{{ result.rating }}</span>
        <span class="text-gray-500">({{ result.reviews }} –≤—ñ–¥–≥—É–∫—ñ–≤)</span>
        </div>
        <div class="flex items-center space-x-2 text-sm">
        <i class="fas fa-user-check text-blue-500"></i>
        <span>{{ result.sellerType }}</span>
        </div>
        </div>

        <div class="bg-gray-50 rounded-lg p-3 space-y-2 text-sm">
        <div class="flex items-center space-x-2">
        <i :class="getDeliveryIcon(result.type)"></i>
        <span>{{ result.delivery }}</span>
        </div>
        <div class="flex items-center space-x-2">
        <i class="fas fa-map-marker-alt text-gray-500"></i>
        <span class="truncate">{{ result.location.address }}</span>
        </div>
        </div>
        </div>

        <div class="flex flex-wrap gap-2 mt-3">
        <button
        v-if="result.contact?.phone"
        @click="$emit('call-store', result.contact.phone)"
        class="bg-green-500 hover:bg-green-600 text-white px-3 py-2 rounded-lg text-xs sm:text-sm font-semibold flex items-center space-x-1 transition-all hover:scale-105"
        >
        <i class="fas fa-phone"></i>
        <span class="hidden sm:inline">–î–∑–≤–æ–Ω–∏—Ç–∏</span>
        </button>
        <button
        v-if="result.contact?.website"
        @click="$emit('visit-store', result.contact.website)"
        class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-xs sm:text-sm font-semibold flex items-center space-x-1 transition-all hover:scale-105">
        <i class="fas fa-globe"></i>
        <span class="hidden sm:inline">–°–∞–π—Ç</span>
        </button>
        </div>
        </div>
        </div>

        <div class="text-center lg:text-right lg:ml-6">
        <div class="mb-2">
        <div class="flex items-center justify-center lg:justify-end space-x-2 mb-2">
        <span class="text-2xl sm:text-3xl font-bold text-gray-900">
        {{ formatPrice(result.price) }}
        </span>
        <span v-if="result.discount > 0" class="bg-red-500 text-white px-2 py-1 rounded-full text-xs font-bold">
        -{{ result.discount }}%
        </span>
        </div>
        <span :class="[
        'inline-block px-3 py-1 rounded-full text-xs font-bold',
        result.availability === '–í –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ'
        ? 'bg-green-100 text-green-700'
        : 'bg-yellow-100 text-yellow-700'
        ]">
        {{ result.availability || '–í –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ' }}
        </span>
        </div>
        </div>
        </div>
        </div>
        </div>
        </div>
        `
    };

    // Results Map Component
    const ResultsMap = {
        props: ['results', 'selectedStore'],
        emits: ['select-store', 'call-store', 'visit-store'],
        methods: {
            formatPrice: utils.formatPrice,
            getMarkerPosition(index) {
                return {
                    left: (20 + (index % 3) * 25 + Math.random() * 10) + '%',
                    top: (25 + Math.floor(index / 3) * 30 + Math.random() * 10) + '%'
                };
            }
        },
        template: `
        <div class="ai-card rounded-2xl shadow-xl p-4 sm:p-6">
        <h3 class="text-xl sm:text-2xl font-bold text-gray-900 mb-4 sm:mb-6 text-center">–®–Ü-–∫–∞—Ä—Ç–∞ –º–∞–≥–∞–∑–∏–Ω—ñ–≤</h3>

        <div class="bg-gradient-to-br from-blue-100 to-purple-100 rounded-2xl h-64 sm:h-96 relative overflow-hidden">
        <div v-for="(result, index) in results.slice(0, 6)"
        :key="result.id"
        class="absolute cursor-pointer transform -translate-x-1/2 -translate-y-1/2 group"
        :style="getMarkerPosition(index)"
        @click="$emit('select-store', result)">
        <div :class="result.color + ' p-2 sm:p-3 rounded-full shadow-lg group-hover:scale-110 transition-all'">
        <span class="text-white text-sm sm:text-xl">{{ result.logo }}</span>
        </div>
        </div>
        </div>

        <div v-if="selectedStore" class="mt-4 sm:mt-6 bg-gray-50 rounded-xl p-4">
        <div class="flex items-center space-x-3 mb-3">
        <div :class="selectedStore.color + ' p-2 sm:p-3 rounded-xl text-white text-lg sm:text-2xl'">
        {{ selectedStore.logo }}
        </div>
        <div class="flex-1 min-w-0">
        <h4 class="text-lg sm:text-xl font-bold text-gray-900 truncate">{{ selectedStore.store }}</h4>
        <p class="text-sm text-gray-600 truncate">{{ selectedStore.location.address }}</p>
        </div>
        </div>
        <div class="text-center">
        <span class="text-xl sm:text-2xl font-bold text-purple-600">{{ formatPrice(selectedStore.price) }}</span>
        </div>
        <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3 mt-3">
        <button
        v-if="selectedStore.contact?.phone"
        @click="$emit('call-store', selectedStore.contact.phone)"
        class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg flex items-center justify-center space-x-2 transition-all"
        >
        <i class="fas fa-phone"></i>
        <span>–î–∑–≤–æ–Ω–∏—Ç–∏</span>
        </button>
        <button
        v-if="selectedStore.contact?.website"
        @click="$emit('visit-store', selectedStore.contact.website)"
        class="ai-gradient text-white px-4 py-2 rounded-lg transition-all">
        –ü–µ—Ä–µ–π—Ç–∏ –≤ –º–∞–≥–∞–∑–∏–Ω
        </button>
        </div>
        </div>
        </div>
        `
    };

    // Register all components globally
    const app = createApp({

        setup() {
            // API Service Instance
            const apiService = new PriceFinderAPI();

            // Reactive state
            const selectedImage = ref(null);
            const selectedFile = ref(null);
            const isAnalyzing = ref(false);
            const results = ref([]);
            const productName = ref('');
            const viewMode = ref('list');
            const selectedStore = ref(null);
            const searchMode = ref('photo');
            const textQuery = ref('');
            const apiStatus = ref('checking');
            const errorMessage = ref('');
            const isLoading = ref(true);

            // Computed properties
            const minPrice = computed(() => {
                if (results.value.length === 0) return 0;
                return Math.min(...results.value.map(r => r.price || 0).filter(p => p > 0));
            });

            const internationalCount = computed(() => {
                return results.value.filter(r => r.location?.region === 'International').length;
            });

            const localCount = computed(() => {
                return results.value.filter(r => r.location?.region === 'Local').length;
            });

            // Methods
            const checkApiStatus = async () => {
                apiStatus.value = await apiService.checkStatus();
            };

            const handleImageUpload = (event) => {
                const file = event.target.files[0];
                if (file) {
                    handleFileSelection(file);
                }
            };

            const handleFileSelection = (file) => {
                if (!file.type.startsWith('image/')) {
                    showError('–ë—É–¥—å –ª–∞—Å–∫–∞, –æ–±–µ—Ä—ñ—Ç—å —Ñ–∞–π–ª –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è');
                    return;
                }

                if (file.size > 10 * 1024 * 1024) {
                    showError('–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π. –ú–∞–∫—Å–∏–º—É–º 10MB');
                    return;
                }

                selectedFile.value = file;

                const reader = new FileReader();
                reader.onload = (e) => {
                    selectedImage.value = e.target.result;
                    results.value = [];
                    productName.value = '';
                    textQuery.value = '';
                    hideError();
                };
                reader.readAsDataURL(file);
            };

            const analyzeProduct = async () => {
                if (searchMode.value === 'photo' && !selectedFile.value) {
                    showError('–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç–æ–≤–∞—Ä—É');
                    return;
                }

                if (searchMode.value === 'text' && !textQuery.value.trim()) {
                    showError('–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É —Ç–æ–≤–∞—Ä—É');
                    return;
                }

                isAnalyzing.value = true;
                results.value = [];
                hideError();

                try {
                    const data = searchMode.value === 'photo'
                        ? { file: selectedFile.value }
                        : { textQuery: textQuery.value };

                    const response = await apiService.analyzeProduct(searchMode.value, data);

                    if (response.success) {
                        productName.value = response.product?.name || textQuery.value || '–¢–æ–≤–∞—Ä –∑–Ω–∞–π–¥–µ–Ω–æ';

                        results.value = (response.results || []).map((result, index) => ({
                            id: index,
                            store: result.store_name,
                            logo: utils.getStoreIcon(result.store_name),
                            color: utils.getStoreColor(result.store_name),
                            price: result.price_uah,
                            originalPrice: result.original_price,
                            discount: utils.calculateDiscount(result.original_price, result.price_uah),
                            availability: result.availability,
                            rating: result.rating || (4.0 + Math.random()),
                            reviews: result.review_count || (Math.floor(Math.random() * 500) + 50),
                            delivery: result.delivery_time,
                            location: result.location || { address: '–ê–¥—Ä–µ—Å–∞ —É—Ç–æ—á–Ω—é—î—Ç—å—Å—è' },
                            contact: result.contact || {},
                            type: utils.determineStoreType(result),
                            sellerType: result.store_type === 'official_retailer' ? '–û—Ñ—ñ—Ü—ñ–π–Ω–∏–π –º–∞–≥–∞–∑–∏–Ω' : '–ú–∞–≥–∞–∑–∏–Ω',
                            aiScore: (Math.random() * 30 + 70).toFixed(1)
                        }));

                        results.value.sort((a, b) => (a.price || 0) - (b.price || 0));
                    } else {
                        showError(response.error || '–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞');
                    }
                } catch (error) {
                    console.error('Analysis error:', error);

                    if (error.code === 'ECONNABORTED') {
                        showError('–ß–∞—Å –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è –≤–∏—á–µ—Ä–ø–∞–Ω–æ. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑');
                    } else if (error.response?.status === 413) {
                        showError('–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞');
                    } else if (error.response?.status >= 500) {
                        showError('–ü–æ–º–∏–ª–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞. –°–ø—Ä–æ–±—É–π—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ');
                    } else if (error.response?.data?.error) {
                        showError(error.response.data.error);
                    } else {
                        showError('–ü–æ–º–∏–ª–∫–∞ –∑\'—î–¥–Ω–∞–Ω–Ω—è –∑ —Å–µ—Ä–≤–µ—Ä–æ–º');
                    }
                } finally {
                    isAnalyzing.value = false;
                }
            };

            const showError = (message) => {
                errorMessage.value = message;
                setTimeout(hideError, 5000);
            };

            const hideError = () => {
                errorMessage.value = '';
            };

            const setPhotoMode = () => {
                searchMode.value = 'photo';
                textQuery.value = '';
                results.value = [];
                productName.value = '';
                hideError();
            };

            const setTextMode = () => {
                searchMode.value = 'text';
                selectedImage.value = null;
                selectedFile.value = null;
                results.value = [];
                productName.value = '';
                hideError();
            };

            const selectStore = (store) => {
                selectedStore.value = store;
            };

            const setSuggestion = (suggestion) => {
                textQuery.value = suggestion;
            };

            const handleKeyPress = (event) => {
                if (event.key === 'Enter' && !isAnalyzing.value && textQuery.value.trim()) {
                    analyzeProduct();
                }
            };

            const callStore = (phone) => {
                if (phone) {
                    window.open(`tel:${phone}`, '_self');
                }
            };

            const visitStore = (website) => {
                if (website) {
                    window.open(`https://${website}`, '_blank');
        }
        };

        // Drag & Drop setup
        const setupDragAndDrop = async () => {
        await nextTick();
        const uploadArea = document.querySelector('#upload-area');
        if (!uploadArea) return;

        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        uploadArea.addEventListener(eventName, (e) => {
        e.preventDefault();
        e.stopPropagation();
        });
        });

        ['dragenter', 'dragover'].forEach(eventName => {
        uploadArea.addEventListener(eventName, () => {
        uploadArea.classList.add('drag-over');
        });
        });

        ['dragleave', 'drop'].forEach(eventName => {
        uploadArea.addEventListener(eventName, () => {
        uploadArea.classList.remove('drag-over');
        });
        });

        uploadArea.addEventListener('drop', (e) => {
        const files = e.dataTransfer.files;
        if (files.length > 0) {
        handleFileSelection(files[0]);
        }
        });
        };

        // Lifecycle
        onMounted(async () => {
        await checkApiStatus();
        setTimeout(() => {
        isLoading.value = false;
        setupDragAndDrop();
        }, 500);
        });

        return {
        selectedImage,
        isAnalyzing,
        results,
        productName,
        viewMode,
        selectedStore,
        searchMode,
        textQuery,
        apiStatus,
        errorMessage,
        isLoading,
        minPrice,
        internationalCount,
        localCount,
        handleImageUpload,
        handleFileSelection,
        analyzeProduct,
        hideError,
        setPhotoMode,
        setTextMode,
        selectStore,
        setSuggestion,
        handleKeyPress,
        callStore,
        visitStore
        };
        }
        });

        // Register all components globally
        app.component('AppHeader', AppHeader);
        app.component('ErrorMessage', ErrorMessage);
        app.component('SearchSection', SearchSection);
        app.component('PhotoSearch', PhotoSearch);
        app.component('TextSearch', TextSearch);
        app.component('AnalysisLoading', AnalysisLoading);
        app.component('ResultsSection', ResultsSection);
        app.component('ResultsList', ResultsList);
        app.component('ResultsMap', ResultsMap);

        // Mount the app
        app.mount('#app');
</script>

<!-- Service Worker Registration -->
<script>
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js').catch(console.error);
    }
</script>
</body>
</html>